

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.20.7">
    <meta name="theme" content="Tranquilpeak 0.3.1-BETA">
    <title>Aggregating NBA data, PostgreSQL vs MongoDB</title>
    <meta name="author" content="Dimitri Fontaine">
    <meta name="keywords" content="">

    <link rel="icon" href="/favicon.ico">
    

    
    <meta name="description" content="When reading the article
Crunching 30 Years of NBA Data with MongoDB Aggregation I coulnd&rsquo;t help but
think that we&rsquo;ve been enjoying
aggregates in SQL for 3 or 4 decades already.
When using
PostgreSQL it&rsquo;s even easy to actually add your own aggregates
given the SQL command
create aggregate.

">
    <meta property="og:description" content="When reading the article
Crunching 30 Years of NBA Data with MongoDB Aggregation I coulnd&rsquo;t help but
think that we&rsquo;ve been enjoying
aggregates in SQL for 3 or 4 decades already.
When using
PostgreSQL it&rsquo;s even easy to actually add your own aggregates
given the SQL command
create aggregate.

">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Aggregating NBA data, PostgreSQL vs MongoDB">
    <meta property="og:url" content="/blog/2014/02/aggregating-nba-data-postgresql-vs-mongodb/">
    <meta property="og:site_name" content="Dimitri Fontaine, PostgreSQL Expert">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Dimitri Fontaine, PostgreSQL Expert">
    <meta name="twitter:description" content="When reading the article
Crunching 30 Years of NBA Data with MongoDB Aggregation I coulnd&rsquo;t help but
think that we&rsquo;ve been enjoying
aggregates in SQL for 3 or 4 decades already.
When using
PostgreSQL it&rsquo;s even easy to actually add your own aggregates
given the SQL command
create aggregate.

">
    
      <meta name="twitter:creator" content="@tapoueh">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/7b615d104c506aa0a49e17151fa94d9f?s=640">
    

    
      <meta property="og:image" content="http://tapoueh.org/img/old/postgresql-mongodb.jpg">
    
    
      <meta property="og:image" content="http://tapoueh.org/img/old/postgresql-mongodb.jpg">
    
    

    

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" />
    
    
    <link rel="stylesheet" href="/css/style-u6mk0ojoywresbx8iepslrmmhl4stuhrsxuwhkpwrkrx7mryjcaimasnk4pi.min.css" />
    
    
      <link rel="stylesheet" href="http://tapoueh.org//css/dim.css">
    

    
      
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-47059482-1', 'auto');
ga('send', 'pageview');
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Dimitri Fontaine, PostgreSQL Expert</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/7b615d104c506aa0a49e17151fa94d9f?s=110" alt="" />
        </a>
        <h4 class="sidebar-profile-name">Dimitri Fontaine</h4>
        
          <h5 class="sidebar-profile-bio">PostgreSQL Major Contributor</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-pagelines"></i>
      
      <span class="sidebar-button-desc">Blog</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/about/">
    
      <i class="sidebar-button-icon fa fa-lg fa-beer"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories/yesql/">
    
      <i class="sidebar-button-icon fa fa-lg fa-database"></i>
      
      <span class="sidebar-button-desc">YeSQL</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://masteringpostgresql.com" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-book"></i>
      
      <span class="sidebar-button-desc">Mastering PostgreSQL</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dimitri" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/tapoueh" target="_blank">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-left
              post-header-cover--partial"
       style="background-image:url('/img/old/postgresql-mongodb.jpg')"
       data-behavior="2">
    
      <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Aggregating NBA data, PostgreSQL vs MongoDB
    </h1>
  
  <div class="postShorten-meta post-meta">
  
    <time itemprop="datePublished" datetime="2014-02-17T23:40:00&#43;01:00">
      
  
  
  
  
    Monday 17 Feb 2014
  

    </time>
  
  
  
  
    <span></span>
    
      <a class="category-link" href="/categories/postgresql">PostgreSQL</a>, 
    
      <a class="category-link" href="/categories/yesql">YeSQL</a>
    
  


</div>

</div>
    
  </div>


      <div id="main" data-behavior="2"
        class="hasCover
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>When reading the article
<a href="http://thecodebarbarian.wordpress.com/2014/02/14/crunching-30-years-of-nba-data-with-mongodb-aggregation/">Crunching 30 Years of NBA Data with MongoDB Aggregation</a> I coulnd&rsquo;t help but
think that we&rsquo;ve been enjoying
<a href="http://www.postgresql.org/docs/current/static/tutorial-agg.html">aggregates</a> in SQL for 3 or 4 decades already.
When using
<a href="http://www.postgresql.org/">PostgreSQL</a> it&rsquo;s even easy to actually add your own aggregates
given the SQL command
<a href="http://www.postgresql.org/docs/current/static/sql-createaggregate.html">create aggregate</a>.</p>

<p></p>

<p><center><em>Photo Credit: <a href="https://www.flickr.com/photos/57426425@N07/6005436411/sizes/z/">Copyright All rights reserved by Segward Graupner</a></em></center></p>

<p>The next step after thinking how obvious the queries written in the
mentionned article would be to express in SQL was to actually load the data
into PostgreSQL and write the aggregate queries, of course.</p>

<h1 id="table-of-contents"></h1><nav id="TableOfContents">
<ul>
<li><a href="#loading-the-data">Loading the data</a></li>
<li><a href="#running-the-aggregates">Running the Aggregates</a></li>
<li><a href="#correlating-stats-with-wins">Correlating stats with wins</a></li>
<li><a href="#defensive-rebounds-and-total-rebounds-versus-win-percentage">Defensive Rebounds and Total Rebounds Versus Win Percentage</a></li>
<li><a href="#interesting-factoid">Interesting factoid</a></li>
<li><a href="#total-rebounds-and-wins">Total rebounds and wins</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>

<h1 id="loading-the-data">Loading the data</h1>

<p>With the help of a little bit of
<em>Common Lisp</em> code and using the
<a href="https://github.com/archimag/mongo-cl-driver">mongo-cl-driver</a> it was easy enough to parse the given
<a href="http://bsonspec.org/">BSON</a> file. What was
more complex was to actually understand enough of the data model to produce
a relational design out of it, avoiding data redundancy as much as possible.</p>

<p>We call that step
<em>normalization</em> in old-style relational databases, and the
goal of that process is to avoid
<em>functional dependency</em> so that the data is
easier to understand, verify and process the data once loaded.</p>

<p>For instance, rather than have both scores from each team and a column
<code>won</code>
per team, which would be a boolean but is a number in the given
<em>BSON</em> file,
we store only the scores. Here&rsquo;s the main table definition of the stats we
are going to be playing with, the
<code>game</code> table:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">create</span> <span style="color: #0000aa">table</span> nba.game (
  id          <span style="color: #00aaaa">serial</span> <span style="color: #0000aa">primary</span> <span style="color: #0000aa">key</span>,
  <span style="color: #00aaaa">date</span>        timestamptz,
  <span style="color: #0000aa">host</span>        <span style="color: #00aaaa">int</span> <span style="color: #0000aa">references</span> nba.team(id),
  guest       <span style="color: #00aaaa">int</span> <span style="color: #0000aa">references</span> nba.team(id),
  host_score  <span style="color: #00aaaa">int</span>,
  guest_score <span style="color: #00aaaa">int</span>
);
</pre></div>

<p>As much of the aggregates in the referenced article are playing with
statistics from teams who actually
<em>won</em> the game, let&rsquo;s create a view to
simplify our SQL queries thereafter:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">create</span> <span style="color: #0000aa">view</span> winners <span style="color: #0000aa">as</span>
  <span style="color: #0000aa">select</span> id,
         <span style="color: #00aaaa">date</span>,
         <span style="color: #0000aa">case</span> <span style="color: #0000aa">when</span> host_score &gt; guest_score
              <span style="color: #0000aa">then</span> <span style="color: #0000aa">host</span>
              <span style="color: #0000aa">else</span> guest
          <span style="color: #0000aa">end</span> <span style="color: #0000aa">as</span> winner
    <span style="color: #0000aa">from</span> game;
</pre></div>

<p>If you&rsquo;re not doing much SQL, remember that creating such a view is common
practice in the relational world.</p>

<h1 id="running-the-aggregates">Running the Aggregates</h1>

<p>Now that we have the extra useful view, it&rsquo;s possible to implement the first
<a href="http://www.mongodb.org/">MongoDB</a> query in SQL. First, let&rsquo;s have a look at the MongoDB query:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>db.games.aggregate([
  {
    $match : {
      date : {
        $gt : ISODate(<span style="color: #aa5500">&quot;1999-08-01T00:00:00Z&quot;</span>),
        $lt : ISODate(<span style="color: #aa5500">&quot;2000-08-01T00:00:00Z&quot;</span>)
      }
    }
  },
  {
    $unwind : <span style="color: #aa5500">&#39;$teams&#39;</span>
  },
  {
    $match : {
      <span style="color: #aa5500">&#39;teams.won&#39;</span> : <span style="color: #009999">1</span>
    }
  },
  {
    $group : {
      _id : <span style="color: #aa5500">&#39;$teams.name&#39;</span>,
      wins : { $sum : <span style="color: #009999">1</span> }
    }
  },
  {
    $sort : { wins : -<span style="color: #009999">1</span> }
  },
  {
    $limit : <span style="color: #009999">5</span>
  }
]);
</pre></div>

<p>I don&rsquo;t know about you, but I have quite a hard time deciphering what that
query is actually doing, and when the explanation text talks about
<em>using a
6-stage pipeline</em> my understanding is that the application developper has
been writing the
<em>execution plan</em> of the query here. Let&rsquo;s ignore the query
format itself, as it&rsquo;s obviously meant to be generated by a tool rather than
typed by a human being.</p>

<p>Here&rsquo;s the same query in SQL, with the result this time:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>  <span style="color: #0000aa">SELECT</span> abbrev, name, <span style="color: #0000aa">count</span>(*)
    <span style="color: #0000aa">FROM</span> winners <span style="color: #0000aa">JOIN</span> team <span style="color: #0000aa">ON</span> team.id = winners.winner
   <span style="color: #0000aa">WHERE</span>     <span style="color: #00aaaa">date</span> &gt; <span style="color: #aa5500">&#39;1999-08-01T00:00:00Z&#39;</span>
         <span style="color: #0000aa">AND</span> <span style="color: #00aaaa">date</span> &lt; <span style="color: #aa5500">&#39;2000-08-01T00:00:00Z&#39;</span>
<span style="color: #0000aa">GROUP</span> <span style="color: #0000aa">BY</span> winner, abbrev, name
<span style="color: #0000aa">ORDER</span> <span style="color: #0000aa">BY</span> <span style="color: #0000aa">count</span>(*) <span style="color: #0000aa">DESC</span>
   <span style="color: #0000aa">LIMIT</span> <span style="color: #009999">5</span>;

 abbrev |          name          | <span style="color: #0000aa">count</span> 
<span style="color: #aaaaaa; font-style: italic">--------+------------------------+-------</span>
 LAL    | Los Angeles Lakers     |    <span style="color: #009999">67</span>
 POR    | Portland Trail Blazers |    <span style="color: #009999">59</span>
 IND    | Indiana Pacers         |    <span style="color: #009999">56</span>
 UTA    | Utah Jazz              |    <span style="color: #009999">55</span>
 SAS    | San Antonio Spurs      |    <span style="color: #009999">53</span>
(<span style="color: #009999">5</span> <span style="color: #0000aa">rows</span>)

Time: <span style="color: #009999">8</span>.<span style="color: #009999">101</span> ms
</pre></div>

<p>What we have here is a pretty basic query using a
<em>join</em>, a
<em>where</em> clause to
restrict the data set we are playing with, a
<em>group by</em> clause to define which
data to compute the aggregates against, with an
<em>order by</em> and a
<em>limit</em> clause
for presenting the result. To be realistic, if you&rsquo;ve ever done any SQL at
all, then you know how to read that query because you&rsquo;ve been writing dozens
of similar ones.</p>

<p>Here&rsquo;s, as in the original article, the same query against a much larger
data set this time, with all games of the 2000s decade:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>   <span style="color: #0000aa">SELECT</span> abbrev, name, <span style="color: #0000aa">count</span>(*)
     <span style="color: #0000aa">FROM</span> winners <span style="color: #0000aa">join</span> team <span style="color: #0000aa">on</span> team.id = winners.winner
    <span style="color: #0000aa">WHERE</span>     <span style="color: #00aaaa">date</span> &gt; <span style="color: #aa5500">&#39;2000-08-01T00:00:00Z&#39;</span>
          <span style="color: #0000aa">AND</span> <span style="color: #00aaaa">date</span> &lt; <span style="color: #aa5500">&#39;2010-08-01T00:00:00Z&#39;</span>
 <span style="color: #0000aa">GROUP</span> <span style="color: #0000aa">BY</span> winner, abbrev, name
 <span style="color: #0000aa">ORDER</span> <span style="color: #0000aa">BY</span> <span style="color: #0000aa">count</span>(*) <span style="color: #0000aa">DESC</span>
    <span style="color: #0000aa">LIMIT</span> <span style="color: #009999">5</span>;

 abbrev |        name        | <span style="color: #0000aa">count</span> 
<span style="color: #aaaaaa; font-style: italic">--------+--------------------+-------</span>
 SAS    | San Antonio Spurs  |   <span style="color: #009999">579</span>
 DAL    | Dallas Mavericks   |   <span style="color: #009999">568</span>
 LAL    | Los Angeles Lakers |   <span style="color: #009999">524</span>
 PHO    | Phoenix Suns       |   <span style="color: #009999">495</span>
 DET    | Detroit Pistons    |   <span style="color: #009999">489</span>
(<span style="color: #009999">5</span> <span style="color: #0000aa">rows</span>)

Time: <span style="color: #009999">24</span>.<span style="color: #009999">713</span> ms
</pre></div>

<h1 id="correlating-stats-with-wins">Correlating stats with wins</h1>

<p>The goal here is to compute how often a team wins when they record more
defensive rebounds than their opponent across the entire data set.</p>

<p>To be able to compute the percentage, we have to have a count of all
registered games, of course. Then we are going to count how many times the
winner team registered a greater
<em>team_stats.drb</em> than the loser, and
<em>count
how many times</em> in SQL is usually written as a
<code>sum(case when &lt;condition&gt; then
1 else 0 end)</code>, which is what we&rsquo;re doing here:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">select</span> <span style="color: #0000aa">count</span>(*) <span style="color: #0000aa">as</span> games,
       <span style="color: #0000aa">sum</span>(<span style="color: #0000aa">case</span> <span style="color: #0000aa">when</span> ws.drb &gt; ls.drb <span style="color: #0000aa">then</span> <span style="color: #009999">1</span> <span style="color: #0000aa">else</span> <span style="color: #009999">0</span> <span style="color: #0000aa">end</span>) <span style="color: #0000aa">as</span> drb,
       <span style="color: #0000aa">sum</span>(<span style="color: #0000aa">case</span> <span style="color: #0000aa">when</span> ws.drb &gt; ls.drb <span style="color: #0000aa">then</span> <span style="color: #009999">1</span> <span style="color: #0000aa">else</span> <span style="color: #009999">0</span> <span style="color: #0000aa">end</span>)::<span style="color: #00aaaa">float</span> / <span style="color: #0000aa">count</span>(*) * <span style="color: #009999">100</span> <span style="color: #0000aa">as</span> pct
  <span style="color: #0000aa">from</span> winlose wl
       <span style="color: #0000aa">join</span> team w <span style="color: #0000aa">on</span> wl.winner = w.id
       <span style="color: #0000aa">join</span> team l <span style="color: #0000aa">on</span> wl.loser = l.id
       <span style="color: #0000aa">join</span> team_stats ws <span style="color: #0000aa">on</span> ws.game = wl.id <span style="color: #0000aa">and</span> ws.team = wl.winner
       <span style="color: #0000aa">join</span> team_stats ls <span style="color: #0000aa">on</span> ls.game = wl.id <span style="color: #0000aa">and</span> ls.team = wl.loser;

 games |  drb  |       pct        
<span style="color: #aaaaaa; font-style: italic">-------+-------+------------------</span>
 <span style="color: #009999">31686</span> | <span style="color: #009999">22292</span> | <span style="color: #009999">70</span>.<span style="color: #009999">3528372151739</span>
(<span style="color: #009999">1</span> <span style="color: #0000aa">row</span>)

Time: <span style="color: #009999">276</span>.<span style="color: #009999">669</span> ms
</pre></div>

<p>We note here than in the original MongoDB article the aggregation query is
short of computing the
<em>percentage</em> directly, apparently it&rsquo;s been done in the
client tool, maybe using a
<em>spreadsheet</em> application or something.</p>

<h1 id="defensive-rebounds-and-total-rebounds-versus-win-percentage">Defensive Rebounds and Total Rebounds Versus Win Percentage</h1>




<div class="figure fig25 right dim-margin" >
  
    <img class="fig-img" src="/img/old/DReboundsVandy.320.png" >
  
  
</div>


<p>Next, still following on our inspirational article
<a href="http://thecodebarbarian.wordpress.com/2014/02/14/crunching-30-years-of-nba-data-with-mongodb-aggregation/">Crunching 30 Years of NBA Data with MongoDB Aggregation</a>, we’re going to
compute what percentage of the time a team wins as a function of the number
of defensive rebounds they recorded.</p>

<p>I&rsquo;m not sure I understand what they achieve with averaging ones when a team
wins and zero when a team loses, so I couldn&rsquo;t quite reproduce their result.
Here&rsquo;s an approaching query tho:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">with</span> game_stats <span style="color: #0000aa">as</span> (
    <span style="color: #0000aa">select</span> t.id, <span style="color: #0000aa">count</span>(*)
      <span style="color: #0000aa">from</span> team t <span style="color: #0000aa">join</span> game <span style="color: #0000aa">on</span> game.<span style="color: #0000aa">host</span> = t.id <span style="color: #0000aa">or</span> game.guest = t.id
   <span style="color: #0000aa">group</span> <span style="color: #0000aa">by</span> t.id
)
<span style="color: #0000aa">select</span> ts.team, round(<span style="color: #0000aa">avg</span>(drb), <span style="color: #009999">2</span>) <span style="color: #0000aa">as</span> drb,
       round(<span style="color: #0000aa">count</span>(*) / gs.<span style="color: #0000aa">count</span>::<span style="color: #00aaaa">numeric</span> * <span style="color: #009999">100</span>, <span style="color: #009999">2</span>) <span style="color: #0000aa">as</span> winpct,
       <span style="color: #0000aa">count</span>(*) <span style="color: #0000aa">as</span> wins, gs.<span style="color: #0000aa">count</span> <span style="color: #0000aa">as</span> games
  <span style="color: #0000aa">from</span> team_stats ts
       <span style="color: #0000aa">join</span> game <span style="color: #0000aa">on</span> game.id = ts.game
                <span style="color: #0000aa">and</span> game.<span style="color: #0000aa">host</span> = ts.team
                <span style="color: #0000aa">and</span> game.host_score &gt; game.guest_score
       <span style="color: #0000aa">join</span> game_stats gs <span style="color: #0000aa">on</span> gs.id = ts.team
<span style="color: #0000aa">group</span> <span style="color: #0000aa">by</span> ts.team, gs.<span style="color: #0000aa">count</span>;

 team |  drb  | winpct | wins | games 
<span style="color: #aaaaaa; font-style: italic">------+-------+--------+------+-------</span>
    <span style="color: #009999">4</span> | <span style="color: #009999">31</span>.<span style="color: #009999">59</span> |  <span style="color: #009999">31</span>.<span style="color: #009999">46</span> |  <span style="color: #009999">710</span> |  <span style="color: #009999">2257</span>
    <span style="color: #009999">7</span> | <span style="color: #009999">32</span>.<span style="color: #009999">55</span> |  <span style="color: #009999">31</span>.<span style="color: #009999">89</span> |  <span style="color: #009999">720</span> |  <span style="color: #009999">2258</span>
   <span style="color: #009999">16</span> | <span style="color: #009999">31</span>.<span style="color: #009999">70</span> |  <span style="color: #009999">37</span>.<span style="color: #009999">62</span> |  <span style="color: #009999">849</span> |  <span style="color: #009999">2257</span>
</pre></div>

<p>I only pasted the first few lines of the result because I&rsquo;m not sure how to
make sense of it, really.</p>

<h1 id="interesting-factoid">Interesting factoid</h1>

<p>What I find most interesting in the following
<em>factoid</em> proposed in the
MongoDB article is the complete lack of the query you need to run in order
to grab the matching data:</p>

<blockquote>
<p>An interesting factoid: the team that recorded the fewest defensive rebounds
in a win was the 1995-96 Toronto Raptors, who beat the Milwaukee Bucks 93-87
on 12/26/1995 despite recording only 14 defensive rebounds.</p>
</blockquote>

<p>When doing the necessary query in SQL, using a
<a href="http://www.postgresql.org/docs/current/static/queries-with.html">Common Table Expression</a> (the
<code>WITH</code> syntax) and a
<a href="http://www.postgresql.org/docs/9.3/static/tutorial-window.html">Window Function</a> for good measure, we get actually 4
different games with the minimum defensive rebounds in our history of NBA
games, 14:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">with</span> stats(game, team, drb, <span style="color: #0000aa">min</span>) <span style="color: #0000aa">as</span> (
    <span style="color: #0000aa">select</span> ts.game, ts.team, drb, <span style="color: #0000aa">min</span>(drb) over ()
      <span style="color: #0000aa">from</span> team_stats ts
           <span style="color: #0000aa">join</span> winners w <span style="color: #0000aa">on</span> w.id = ts.game <span style="color: #0000aa">and</span> w.winner = ts.team
)
<span style="color: #0000aa">select</span> game.<span style="color: #00aaaa">date</span>::<span style="color: #00aaaa">date</span>,
       <span style="color: #0000aa">host</span>.name || <span style="color: #aa5500">&#39; -- &#39;</span> || host_score <span style="color: #0000aa">as</span> <span style="color: #0000aa">host</span>,
       guest.name || <span style="color: #aa5500">&#39; -- &#39;</span> || guest_score <span style="color: #0000aa">as</span> guest,
       stats.drb <span style="color: #0000aa">as</span> winner_drb
  <span style="color: #0000aa">from</span> stats
       <span style="color: #0000aa">join</span> game <span style="color: #0000aa">on</span> game.id = stats.game
       <span style="color: #0000aa">join</span> team <span style="color: #0000aa">host</span> <span style="color: #0000aa">on</span> <span style="color: #0000aa">host</span>.id = game.<span style="color: #0000aa">host</span>
       <span style="color: #0000aa">join</span> team guest <span style="color: #0000aa">on</span> guest.id = game.guest
 <span style="color: #0000aa">where</span> drb = <span style="color: #0000aa">min</span>;

-[ RECORD <span style="color: #009999">1</span> ]<span style="color: #aaaaaa; font-style: italic">----------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">1995</span>-<span style="color: #009999">12</span>-<span style="color: #009999">26</span>
<span style="color: #0000aa">host</span>       | Toronto Raptors <span style="color: #aaaaaa; font-style: italic">-- 93</span>
guest      | Milwaukee Bucks <span style="color: #aaaaaa; font-style: italic">-- 87</span>
winner_drb | <span style="color: #009999">14</span>
-[ RECORD <span style="color: #009999">2</span> ]<span style="color: #aaaaaa; font-style: italic">----------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">1996</span>-<span style="color: #009999">02</span>-<span style="color: #009999">02</span>
<span style="color: #0000aa">host</span>       | Golden <span style="color: #0000aa">State</span> Warriors <span style="color: #aaaaaa; font-style: italic">-- 114</span>
guest      | Toronto Raptors <span style="color: #aaaaaa; font-style: italic">-- 111</span>
winner_drb | <span style="color: #009999">14</span>
-[ RECORD <span style="color: #009999">3</span> ]<span style="color: #aaaaaa; font-style: italic">----------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">1998</span>-<span style="color: #009999">03</span>-<span style="color: #009999">31</span>
<span style="color: #0000aa">host</span>       | Vancouver Grizzlies <span style="color: #aaaaaa; font-style: italic">-- 101</span>
guest      | Dallas Mavericks <span style="color: #aaaaaa; font-style: italic">-- 104</span>
winner_drb | <span style="color: #009999">14</span>
-[ RECORD <span style="color: #009999">4</span> ]<span style="color: #aaaaaa; font-style: italic">----------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">2009</span>-<span style="color: #009999">01</span>-<span style="color: #009999">14</span>
<span style="color: #0000aa">host</span>       | <span style="color: #0000aa">New</span> York Knicks <span style="color: #aaaaaa; font-style: italic">-- 128</span>
guest      | Washington Wizards <span style="color: #aaaaaa; font-style: italic">-- 122</span>
winner_drb | <span style="color: #009999">14</span>

Time: <span style="color: #009999">126</span>.<span style="color: #009999">276</span> ms
</pre></div>

<p>To understand all there&rsquo;s to know about
<em>window functions</em>, have a look at my
article on the topic:
<a href="/blog/2013/08/20-Window-Functions">Understanding Window Functions</a>.</p>

<h1 id="total-rebounds-and-wins">Total rebounds and wins</h1>

<p>The next interesting aside is the following:</p>

<blockquote>
<p>As an aside, the Cleveland Cavaliers beat the New York Knicks 101-97 on
April 11, 1996, despite recording only 21 total rebounds. Inversely, the San
Antonio Spurs lost to the Houston Rockets, 112-110, on January 4, 1992
despite recording 75 total rebounds.</p>
</blockquote>

<p>Which we translate in SQL as the following query:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">with</span> stats <span style="color: #0000aa">as</span> (
    <span style="color: #0000aa">select</span> ts.game, ts.team, trb,
           <span style="color: #0000aa">min</span>(trb) over () <span style="color: #0000aa">as</span> <span style="color: #0000aa">min</span>,
           <span style="color: #0000aa">max</span>(trb) over () <span style="color: #0000aa">as</span> <span style="color: #0000aa">max</span>
      <span style="color: #0000aa">from</span> team_stats ts
           <span style="color: #0000aa">join</span> winners w <span style="color: #0000aa">on</span> w.id = ts.game <span style="color: #0000aa">and</span> w.winner = ts.team
)
<span style="color: #0000aa">select</span> game.<span style="color: #00aaaa">date</span>::<span style="color: #00aaaa">date</span>,
       <span style="color: #0000aa">host</span>.name || <span style="color: #aa5500">&#39; -- &#39;</span> || host_score <span style="color: #0000aa">as</span> <span style="color: #0000aa">host</span>,
       guest.name || <span style="color: #aa5500">&#39; -- &#39;</span> || guest_score <span style="color: #0000aa">as</span> guest,
       stats.trb <span style="color: #0000aa">as</span> winner_trb
  <span style="color: #0000aa">from</span> stats
       <span style="color: #0000aa">join</span> game <span style="color: #0000aa">on</span> game.id = stats.game
       <span style="color: #0000aa">join</span> team <span style="color: #0000aa">host</span> <span style="color: #0000aa">on</span> <span style="color: #0000aa">host</span>.id = game.<span style="color: #0000aa">host</span>
       <span style="color: #0000aa">join</span> team guest <span style="color: #0000aa">on</span> guest.id = game.guest
 <span style="color: #0000aa">where</span> trb = <span style="color: #0000aa">min</span> <span style="color: #0000aa">or</span> trb = <span style="color: #0000aa">max</span>;

-[ RECORD <span style="color: #009999">1</span> ]<span style="color: #aaaaaa; font-style: italic">--------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">1995</span>-<span style="color: #009999">12</span>-<span style="color: #009999">28</span>
<span style="color: #0000aa">host</span>       | Dallas Mavericks <span style="color: #aaaaaa; font-style: italic">-- 103</span>
guest      | Vancouver Grizzlies <span style="color: #aaaaaa; font-style: italic">-- 101</span>
winner_trb | <span style="color: #009999">76</span>
-[ RECORD <span style="color: #009999">2</span> ]<span style="color: #aaaaaa; font-style: italic">--------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">1996</span>-<span style="color: #009999">04</span>-<span style="color: #009999">11</span>
<span style="color: #0000aa">host</span>       | <span style="color: #0000aa">New</span> York Knicks <span style="color: #aaaaaa; font-style: italic">-- 97</span>
guest      | Cleveland Cavaliers <span style="color: #aaaaaa; font-style: italic">-- 101</span>
winner_trb | <span style="color: #009999">21</span>
-[ RECORD <span style="color: #009999">3</span> ]<span style="color: #aaaaaa; font-style: italic">--------------------------</span>
<span style="color: #00aaaa">date</span>       | <span style="color: #009999">2007</span>-<span style="color: #009999">01</span>-<span style="color: #009999">29</span>
<span style="color: #0000aa">host</span>       | Utah Jazz <span style="color: #aaaaaa; font-style: italic">-- 115</span>
guest      | <span style="color: #0000aa">New</span> Jersey Nets <span style="color: #aaaaaa; font-style: italic">-- 116</span>
winner_trb | <span style="color: #009999">21</span>

Time: <span style="color: #009999">127</span>.<span style="color: #009999">771</span> ms
</pre></div>

<p>Again it&rsquo;s easy enough in SQL to have more details about the
<em>aside</em> presented
in our source article, and we get a slightly different story.</p>

<h1 id="conclusion">Conclusion</h1>

<p>It&rsquo;s quite hard for me to appreciate the work done in the
<em>MongoDB
aggregation framework</em> really, when we&rsquo;ve been enjoying advanced aggregation
and statistics in
<a href="http://www.postgresql.org/">PostgreSQL</a> for a very long time. With the addition of
<a href="http://www.postgresql.org/docs/9.3/static/tutorial-window.html">Window Functions</a> and
<a href="http://www.postgresql.org/docs/9.3/static/functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE">Aggregate Functions for Statistics</a> it&rsquo;s possible to
implement advanced analysis right into your SQL queries.</p>




<div class="figure fig25 right dim-margin" >
  
    <img class="fig-img" src="/img/old/sql-logo.png"  alt="PostgreSQL is YeSQL">
  
   
    <span class="caption">PostgreSQL is YeSQL</span>
  
</div>


<p>In next PostgreSQL release the set of analytical functions is going to
expand again with the addition of both
<a href="http://www.postgresql.org/docs/devel/static/functions-aggregate.html#FUNCTIONS-ORDEREDSET-TABLE">Ordered-Set Aggregate Functions</a> (also
known as
<em>inverse distribution</em> functions) and
<a href="http://www.postgresql.org/docs/devel/static/functions-aggregate.html#FUNCTIONS-HYPOTHETICAL-TABLE">Hypothetical-Set Aggregate Functions</a> (also known as
<code>WITHIN GROUP</code>).</p>

<p>When the problem you have to solve involves analyzing data, one of the more
advanced tooling you can find around certainly is the SQL language, in
particular its implementation in PostgreSQL!</p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small"></span><br/>
                    
  <a class="tag tag--primary tag--small" href="http://tapoueh.org//tags/postgresql/">PostgreSQL</a>

  <a class="tag tag--primary tag--small" href="http://tapoueh.org//tags/mongodb/">MongoDB</a>

  <a class="tag tag--primary tag--small" href="http://tapoueh.org//tags/yesql/">YeSQL</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  <div class="post-footer-tags">
    <script async id="_ck_218061" src="https://forms.convertkit.com/218061?v=6"></script>
  </div>
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/blog/2014/02/postgresql-aggregates-and-histograms/" data-tooltip="PostgreSQL, Aggregates and Histograms">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml"></span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/blog/2014/02/postgresql-fosdem-conference/" data-tooltip="PostgreSQL FOSDEM Conference">
          
            <span class="hide-xs hide-sm text-small icon-mr"></span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Aggregating%20NBA%20data%2c%20PostgreSQL%20vs%20MongoDB with @tapoueh: http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#table-of-contents">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2017 Dimitri Fontaine. 
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
        <div class="post-actions-wrap">
  <div class="post-footer-tags">
    <script async id="_ck_218061" src="https://forms.convertkit.com/218061?v=6"></script>
  </div>
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/blog/2014/02/postgresql-aggregates-and-histograms/" data-tooltip="PostgreSQL, Aggregates and Histograms">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml"></span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/blog/2014/02/postgresql-fosdem-conference/" data-tooltip="PostgreSQL FOSDEM Conference">
          
            <span class="hide-xs hide-sm text-small icon-mr"></span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Aggregating%20NBA%20data%2c%20PostgreSQL%20vs%20MongoDB with @tapoueh: http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#table-of-contents">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="2">
  <ul class="share-options">
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
        <i class="fa fa-google-plus"></i><span></span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
        <i class="fa fa-facebook-official"></i><span></span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Aggregating%20NBA%20data%2c%20PostgreSQL%20vs%20MongoDB with @tapoueh: http%3a%2f%2ftapoueh.org%2fblog%2f2014%2f02%2faggregating-nba-data-postgresql-vs-mongodb%2f">
        <i class="fa fa-twitter"></i><span></span>
      </a>
    </li>
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/7b615d104c506aa0a49e17151fa94d9f?s=110" alt="" />
    
    <h4 id="about-card-name">Dimitri Fontaine</h4>
    
      <div id="about-card-bio">PostgreSQL Major Contributor</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Open Source Software Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        France
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center"></div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/07/playing-with-unicode/">
                <h3 class="media-heading">Playing with Unicode</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jul 7, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>The reason why I like Unicode a lot is because it allows me to code in text
based environments and still have nice output. Today, we&rsquo;re going to play
with
<a href="https://en.wikipedia.org/wiki/Regional_Indicator_Symbol">Regional Indicator Symbol</a>,
which is implemented as a Unicode combinaison of letters from 🇦 to 🇿. For
instance, if you display 🇫 then 🇷 concatenated together, you get 🇫🇷. Let&rsquo;s
try that from our <a href="https://www.postgresql.org/">PostgreSQL</a> prompt!</p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/06/postgresql-and-the-calendar/">
                <h3 class="media-heading">PostgreSQL and the calendar</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>The modern calendar is a trap for the young engineer&rsquo;s mind. We deal with
the calendar on a daily basis and until exposed to its insanity it&rsquo;s rather
common to think that calendar based computations are easy. That&rsquo;s until
you&rsquo;ve tried to do it once. A very good read about how the current calendar
came to be the way it is now is Erik&rsquo;s
Naggum <a href="http://naggum.no/lugm-time.html">The Long, Painful History of Time</a>.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/06/sql-and-business-logic/">
                <h3 class="media-heading">SQL and Business Logic</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Business logic is <em>supposed to be</em> the part of the application where you
deal with customer or user facing decisions and computations. It is often
argued that this part should be well separated from the rest of the
technical infrastructure of your code. Of course, SQL and relational
database design is meant to support your business cases (or user stories),
so then we can ask ourselves if SQL should be part of your business logic
implementation. Or actually, how much of your business logic should be SQL?</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/06/exploring-a-data-set-in-sql/">
                <h3 class="media-heading">Exploring a Data Set in SQL</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Sometimes you need to dive in an existing data set that you know very little
about. Let&rsquo;s say we&rsquo;ve been lucky to have had a high level description of
the business case covered by a database, and then access to it. Our next
step is figuring out data organisation, content and quality. Our tool box:
<em>the world&rsquo;s most advanced open source
database</em>, <a href="https://www.postgresql.org">PostgreSQL</a>, and its <em>Structured
Query Language</em>, SQL.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/06/how-to-write-sql/">
                <h3 class="media-heading">How to Write SQL</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p><a href="https://twitter.com/krisajenkins">Kris Jenkins</a> cooked up a very nice way
to embed SQL in your
code: <a href="https://github.com/krisajenkins/yesql">YeSQL for Clojure</a>. The main
idea is that you should be writing your SQL queries in <code>.sql</code> files in your
code repository and maintain them there.</p>

<p>The idea is very good and it is now possible to find alternative
implementations of the <a href="https://clojure.org">Clojure</a> <em>yesql</em> library in
other languages. Today, we are going to have a look at one of them for
the <a href="https://www.python.org">python</a> programming
language: <a href="https://github.com/honza/anosql">anosql</a>.</p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2017/05/find-the-missing-integer/">
                <h3 class="media-heading">Find The Missing Integer</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>A recent interview question that I had to review was spelled like this:</p>

<blockquote>
<p>Find missing int element into array 1..100</p>
</blockquote>

<p>Of course at first read I got it wrong, you have only one integer to look
for into the array. So while the obvious idea was to apply classic <em>sorting</em>
techniques and minimize array traversal to handle complexity (time and
space), it turns out there&rsquo;s a much simpler way to do it if you remember
your math lessons from younger. But is it that much simpler?</p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2016/04/pgconf-us-2016/">
                <h3 class="media-heading">PGConf US 2016</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Apr 4, 2016
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p><a href="https://www.pgconf.us/conferences/2016">PostgreSQL Conference US</a> took
place in New York City and I had the pleasure to be a speaker there. I
presented there a talk about why <em>You’d Better Have Tested Backups</em>. The
important bit is that backups are not interesting, recoveries are. Also the
only way to make sure a backup is successful is to be able to use it for
recovery.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2015/11/all-your-base-conference-2015/">
                <h3 class="media-heading">All Your Base Conference 2015</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2015
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>I had the pleasure to be invited to speak at
<a href="http://allyourbaseconf.com/2015/speakers#dimitri-fontaine">All Your Base Conference 2015</a>
about
<a href="http://www.postgresql.org">PostgreSQL</a> (of course). The conference gathers together lots of user
experience around data management and database products, either in the now
classic meaning of the word (I mean
<em>relational database management systems
here</em>) or the newer set of trade-offs represented by the NoSQL set of tools.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2015/05/postgresql-au-jug-de-montpellier/">
                <h3 class="media-heading">PostgreSQL au JUG de Montpellier</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2015
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><div class="figure fig25 left dim-margin" >
  
    <img class="fig-img" src="/img/old/jug-montpellier-logo.png" >
  
  
</div>


<p>J&rsquo;ai eu le plaisir de présenter PostgreSQL au
<a href="http://www.jug-montpellier.org/">Java User Group de Montpellier</a>
le 20 mai dernier dans le cadre d&rsquo;une soirée
<a href="http://www.jug-montpellier.org/event/36">PostgreSQL is YeSQL</a>. L&rsquo;accueil
réservé par le
<em>JUG</em> a été parfait et je tiens à les remercier pour une très
bonne soirée de partage et d&rsquo;échanges autour de PostgreSQL.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://tapoueh.org/blog/2015/05/quicklisp-and-debian/">
                <h3 class="media-heading">Quicklisp and debian</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2015
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather"><p>Common Lisp users are very happy to use
<a href="https://www.quicklisp.org/beta/">Quicklisp</a> when it comes to
downloading and maintaining dependencies between their own code and the
<a href="http://quickdocs.org/">librairies</a> it is using.</p>

<p></p></div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero=""
         data-message-one=""
         data-message-other="">
         236 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('http://tapoueh.org/images/mayan-calendar.jpg');"></div>
  


    
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.js"></script>


<script src="/js/script-wl33z0n6ocaypepiqrazthtivfrliqijej4rq8ek8gvrv1awftmgjuv8k4zc.min.js"></script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight').each(function(i, block) {
    var code = "";
    hljs.highlightAuto(block.innerText).value.split(/\r\n|\r|\n/).forEach(function(line) {
      code += "<span class=\"line\">" + line + "</span><br>";
    });
    if (code.length > 0) {
      block.innerHTML = code;  
    }
  });
  $('pre > code').each(function(i, block) {
    $(this).addClass('codeblock');
    hljs.highlightBlock(block);
  });
});
</script>

  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'http:\/\/tapoueh.org\/blog\/2014\/02\/aggregating-nba-data-postgresql-vs-mongodb\/';
          
            this.page.identifier = '\/blog\/2014\/02\/aggregating-nba-data-postgresql-vs-mongodb\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'tapoueh';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  





    
  </body>
</html>

